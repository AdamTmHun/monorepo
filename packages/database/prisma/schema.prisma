datasource db {
  provider = "postgresql"
  // localhost database.
  url      = "postgres://postgres:postgres@localhost:5432/postgres"
  //! production database
  // url      = env("PRODUCTION_DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model organization {
  id            String    @id @default(dbgenerated("extensions.uuid_generate_v4()")) @db.Uuid
  name          String
  projects      project[]
  admin_user_id String    @db.Uuid
  admin         user      @relation("admin", fields: [admin_user_id], references: [id])
  members       member[]
  created_at    DateTime  @default(now())
}

model user {
  id         String         @id @default(dbgenerated("extensions.uuid_generate_v4()")) @db.Uuid
  email      String         @unique
  admin_of   organization[] @relation("admin")
  member_of  member[]
  created_at DateTime       @default(now())
}

model member {
  organization_id String       @db.Uuid
  organization    organization @relation(fields: [organization_id], references: [id])
  user_id         String       @db.Uuid
  user            user         @relation(fields: [user_id], references: [id])

  @@id([organization_id, user_id])
}

model project {
  id             String       @id @default(dbgenerated("extensions.uuid_generate_v4()")) @db.Uuid
  api_key        String       @unique
  name           String
  owner_id       String       @db.Uuid
  owner          organization @relation(fields: [owner_id], references: [id])
  default_locale String
  locales        String
  text_keys      key[]

  created_at DateTime @default(now())
}

model key {
  id           Int           @id @default(autoincrement())
  project_id   String        @db.Uuid
  project      project       @relation(fields: [project_id], references: [id])
  key          String
  locale       String
  translations translation[]
  created_at   DateTime      @default(now())
}

model translation {
  id         Int      @id @default(autoincrement())
  key_id     Int
  key        key      @relation(fields: [key_id], references: [id])
  locale     String
  text       String
  created_at DateTime @default(now())
}
